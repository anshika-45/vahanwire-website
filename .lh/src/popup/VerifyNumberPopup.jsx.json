{
    "sourceFile": "src/popup/VerifyNumberPopup.jsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 2,
            "patches": [
                {
                    "date": 1763037981235,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1763038005755,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -41,17 +41,10 @@\n     } finally {\r\n       setLoading(false);\r\n     }\r\n   };\r\n-  useEffect(() => {\r\n-  if (!isOpen) {\r\n-    setNumber(\"\");\r\n-    setError(\"\");\r\n-    setShowError(false);\r\n-  }\r\n-}, [isOpen]);\r\n+  \r\n \r\n-\r\n   const handleOtpBack = () => setShowOtp(false);\r\n   return (\r\n     <>\r\n       {!showOtp && (\r\n"
                },
                {
                    "date": 1763038041079,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -10,16 +10,8 @@\n   const [showError, setShowError] = useState(false);\n   const [showOtp, setShowOtp] = useState(false);\n   const [loading, setLoading] = useState(false);\n \n-  useEffect(() => {\n-    if (!isOpen) {\n-      setNumber(\"\");\n-      setError(\"\");\n-      setShowError(false);\n-    }\n-  }, [isOpen]);\n-\n   if (!isOpen && !showOtp) return null;\n \n   const validatePhone = (num) => /^[6-9]\\d{9}$/.test(num);\n \n"
                }
            ],
            "date": 1763037981234,
            "name": "Commit-0",
            "content": "import React, { useState } from \"react\";\r\nimport Button from \"../components/Button\";\r\nimport phoneGif from \"../assets/Animation.svg\";\r\nimport OtpVerifypopup from \"./OtpVerifypopup\";\r\nimport Modal from \"../components/Modal\";\r\nimport { sendOtp } from \"../api/authApi\";\r\nconst VerifyNumberPopup = ({ isOpen, onClose, isFromLogin = false }) => {\r\n  const [number, setNumber] = useState(\"\");\r\n  const [error, setError] = useState(\"\");\r\n  const [showError, setShowError] = useState(false);\r\n  const [showOtp, setShowOtp] = useState(false);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  if (!isOpen && !showOtp) return null;\r\n\r\n  const validatePhone = (num) => /^[6-9]\\d{9}$/.test(num);\r\n\r\n  const handleVerify = async () => {\r\n    setShowError(true);\r\n\r\n    if (!validatePhone(number)) {\r\n      return setError(\r\n        \"Please enter a valid 10-digit phone number starting with 6-9.\"\r\n      );\r\n    }\r\n\r\n    try {\r\n      setLoading(true);\r\n      setError(\"\");\r\n\r\n      const response = await sendOtp(number);\r\n\r\n      if (response?.success && response?.message === \"OTP sent successfully\") {\r\n        setShowOtp(true);\r\n      } else {\r\n        throw new Error(response?.message || \"Failed to send OTP. Try again.\");\r\n      }\r\n    } catch (err) {\r\n      console.error(\"OTP Error:\", err);\r\n      setError(err.message || \"Something went wrong while sending OTP.\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n  useEffect(() => {\r\n  if (!isOpen) {\r\n    setNumber(\"\");\r\n    setError(\"\");\r\n    setShowError(false);\r\n  }\r\n}, [isOpen]);\r\n\r\n\r\n  const handleOtpBack = () => setShowOtp(false);\r\n  return (\r\n    <>\r\n      {!showOtp && (\r\n        <Modal isOpen={isOpen} onClose={onClose}>\r\n          <div className=\"bg-white rounded-xl p-8 sm:p-8 md:p-10 flex flex-col items-center m-4 my-10\">\r\n            <div className=\"flex justify-center mb-5 sm:mb-7\">\r\n              <img\r\n                src={phoneGif}\r\n                alt=\"Phone Animation\"\r\n                className=\"w-40 h-40  md:w-60 md:h-60\"\r\n                width={240} \r\n                height={240}\r\n                decoding=\"async\"\r\n              />\r\n            </div>\r\n            <h1 className=\"text-lg sm:text-xl md:text-2xl font-semibold text-[#242424] text-center mb-3 sm:mb-4\">\r\n              Verify Your Number\r\n            </h1>\r\n            <label\r\n              htmlFor=\"phone\"\r\n              className=\"w-full text-xs text-[#5C5C5C] mb-1\"\r\n            >\r\n              Phone Number*\r\n            </label>\r\n            <input\r\n              id=\"phone\"\r\n              type=\"tel\"\r\n              placeholder=\"Phone Number\"\r\n              value={number}\r\n              onChange={(e) => {\r\n                setNumber(e.target.value.replace(/[^0-9]/g, \"\"));\r\n                if (showError) setShowError(false);\r\n              }}\r\n              maxLength={10}\r\n              className=\"\r\n        w-full border border-[#BCD2F5] rounded-lg \r\n        px-3 py-2 sm:py-3 \r\n        mb-2 \r\n        focus:outline-none focus:ring-1 focus:ring-[#BCD2F5] \r\n        text-left text-sm bg-[#F8F8F8] text-[#A1A1A1]\r\n      \"\r\n            />\r\n\r\n            {showError && error && (\r\n              <div className=\"text-[#CB0200] text-left text-xs mb-2\">\r\n                {error}\r\n              </div>\r\n            )}\r\n\r\n            <Button\r\n              text={loading ? \"Sending...\" : \"Verify\"}\r\n              disabled={loading}\r\n              className=\"\r\n        w-full bg-[#266DDF] text-white font-semibold \r\n        py-2 sm:py-3 \r\n        rounded-lg hover:bg-blue-700 transition-colors mt-2 \r\n        disabled:opacity-60\r\n      \"\r\n              onClick={handleVerify}\r\n            />\r\n          </div>\r\n        </Modal>\r\n      )}\r\n\r\n      {showOtp && (\r\n        <OtpVerifypopup\r\n          isOpen={showOtp}\r\n          onClose={() => {\r\n            setShowOtp(false);\r\n            onClose();\r\n          }}\r\n          onBack={handleOtpBack}\r\n          phoneNumber={number}\r\n          isFromLogin={isFromLogin}\r\n        />\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default VerifyNumberPopup;\r\n"
        }
    ]
}