{
    "sourceFile": "src/components/InvoiceModal.jsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1763041977816,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1763041977816,
            "name": "Commit-0",
            "content": "import React, { useEffect, useState } from \"react\";\r\nimport { X } from \"lucide-react\";\r\nimport { getAmcInvoice } from \"../api/amcApi\";\r\n\r\nexport default function InvoiceModal({ isOpen, onClose, invoiceId }) {\r\n  const [invoice, setInvoice] = useState(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(\"\");\r\n  \r\n  useEffect(() => {\r\n    if (!isOpen || !invoiceId) return;\r\n\r\n    const fetchInvoice = async () => {\r\n      setLoading(true);\r\n      setError(\"\");\r\n      try {\r\n        const res = await getAmcInvoice(invoiceId);\r\n        console.log(\"lknfwdjcnbb\",res);\r\n        if (res.success) {\r\n          const data = res.data;\r\n          setInvoice({\r\n            customerName: data.user.name,\r\n            phone: data.user.phone,\r\n            invoiceNo: data.invoiceId,\r\n            invoiceDate: new Date(data.createdAt).toLocaleDateString(),\r\n            vehicle: data.vehicle.vehicleName || data.vehicle.model || \"-\",\r\n            year: data.vehicle.year || \"-\",\r\n            brand: data.vehicle.brand,\r\n            model: data.vehicle.model,\r\n            vehicleType: data.vehicle.vehicleType,\r\n            vehicleNumber: data.vehicle.vehicleNumber || \"-\",\r\n            amcPlanType: data.plan.name,\r\n            status: data.payment.paymentStatus,\r\n            payment: data.payment.paymentId,\r\n            serviceCharge: data.plan.price || 0,\r\n            total:  data.plan.price \r\n          });\r\n        } else {\r\n          setError(\"Failed to fetch invoice\");\r\n        }\r\n      } catch (err) {\r\n        console.error(err);\r\n        setError(\"Something went wrong while fetching invoice\");\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchInvoice();\r\n  }, [isOpen, invoiceId]);\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-[9999] grid place-items-center p-3 sm:p-4\" aria-modal=\"true\" role=\"dialog\">\r\n      <div className=\"fixed inset-0 bg-black/40\" onClick={onClose} aria-hidden=\"true\" />\r\n      <div className=\"relative w-full max-w-[480px] bg-white rounded-2xl shadow-2xl border border-slate-200 overflow-hidden\">\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between px-4 sm:px-6 py-2.5 bg-[#D9E7FE] border-b border-slate-200\">\r\n          <h2 className=\"text-sm sm:text-base font-semibold text-slate-800 mx-auto\">Invoice Details</h2>\r\n          <button onClick={onClose} aria-label=\"Close\" className=\"absolute right-4 text-slate-600 hover:text-slate-800\">\r\n            <X className=\"h-5 w-5\" />\r\n          </button>\r\n        </div>\r\n\r\n        {/* Body */}\r\n        <div className=\"px-5 py-4 space-y-3 text-sm text-slate-800\">\r\n          {loading && <p>Loading...</p>}\r\n          {error && <p className=\"text-red-500\">{error}</p>}\r\n          {invoice && (\r\n            <>\r\n              <Section title=\"Bill To\">\r\n                <Item label=\"Name\" value={invoice.customerName} />\r\n                <Item label=\"Phone\" value={invoice.phone} />\r\n              </Section>\r\n\r\n              <Section title=\"Invoice Info\">\r\n                <Item label=\"Invoice No.\" value={invoice.invoiceNo} />\r\n                <Item label=\"Invoice Date\" value={invoice.invoiceDate} />\r\n              </Section>\r\n\r\n              <Section title=\"Vehicle\">\r\n               <Item label=\"Vehicle Brand\" value={invoice.brand} />\r\n               <Item label=\"Vehicle Model\" value={invoice.model} />\r\n               <Item label=\"Vehicle Type\" value={invoice.vehicleType} />\r\n                <Item label=\"Vehicle Number\" value={invoice.vehicleNumber} />\r\n              </Section>\r\n\r\n              <Section title=\"Service Details\">\r\n                <Item label=\"AMC Plan Type\" value={invoice.amcPlanType || \"-\"} />\r\n                <Item label=\"Status\" value={invoice.status} />\r\n                <Item label=\"Payment\" value={invoice.payment} />\r\n              </Section>\r\n\r\n              <Section title=\"Charges\">\r\n                <Item label=\"Service Charge\" value={`₹${invoice.serviceCharge}`} />\r\n              </Section>\r\n            </>\r\n          )}\r\n        </div>\r\n\r\n        {invoice && (\r\n          <div className=\"px-5 pb-4\">\r\n            <div className=\"w-full rounded-xl bg-[#266DDF] px-4 py-3 text-white\">\r\n              <div className=\"flex items-center justify-between text-sm\">\r\n                <span className=\"font-semibold\">Total Amount</span>\r\n                <span className=\"text-base font-bold\">₹{invoice.total}</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction Section({ title, children }) {\r\n  return (\r\n    <section className=\"rounded-xl border border-slate-200 bg-[#FAFAFA] p-3 space-y-2\">\r\n      <h3 className=\"text-[11px] sm:text-xs font-semibold uppercase text-slate-600 tracking-wide\">{title}</h3>\r\n      {children}\r\n    </section>\r\n  );\r\n}\r\n\r\nfunction Item({ label, value }) {\r\n  return (\r\n    <div className=\"flex justify-between text-xs sm:text-sm\">\r\n      <span className=\"text-slate-600\">{label}</span>\r\n      <span className=\"font-medium text-slate-800\">{value}</span>\r\n    </div>\r\n  );\r\n}\r\n\r\n"
        }
    ]
}